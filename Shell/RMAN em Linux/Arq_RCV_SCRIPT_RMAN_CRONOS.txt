run {
CONFIGURE RETENTION POLICY TO REDUNDANCY 1;
CONFIGURE BACKUP OPTIMIZATION OFF;
CONFIGURE DEFAULT DEVICE TYPE TO DISK ;
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/snapcf_DBPTN.f' ;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/copiacontrol%F';
CONFIGURE DEVICE TYPE DISK PARALLELISM 2;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1;
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1;
CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/ora_df_%U';
CONFIGURE MAXSETSIZE TO UNLIMITED;
SHOW ALL;
}
run {
ALLOCATE CHANNEL C1 TYPE DISK FORMAT '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/ora_df_%U' ;
ALLOCATE CHANNEL C2 TYPE DISK FORMAT '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/ora_df_%U' ;
ALLOCATE CHANNEL C3 TYPE DISK FORMAT '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/ora_df_%U' ;
backup current controlfile format '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/control_DBPTN_Thu_07_04_2016_04_%U.ctl' ;
sql 'alter system archive log current';
BACKUP AS COMPRESSED BACKUPSET ARCHIVELOG ALL format '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/archive_DBPTN_Thu_07_04_2016_04_%U' ;
backup as COMPRESSED BACKUPSET database spfile plus archivelog ;
SQL "ALTER DATABASE BACKUP CONTROLFILE TO TRACE AS ''/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/control_DBPTN_Thu_07_04_2016_04.txt''";
backup format '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/spfile_DBPTN_Thu_07_04_2016_04.dbf' spfile ;
CROSSCHECK BACKUP;
REPORT OBSOLETE;
BACKUP AS COMPRESSED BACKUPSET ARCHIVELOG ALL DELETE ALL INPUT format '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/archive_DBPTN_Thu_07_04_2016_04_%U' ;
crosscheck archivelog all ;
Delete noprompt expired archivelog all;
backup current controlfile format '/backup/rman/DBPTN/rman_DBPTN_Thu_07_04_2016_04/control_DBPTN_Thu_07_04_2016_04_%U.ctl' ;
}
~
