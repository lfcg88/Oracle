rem =========================================================================
rem 
rem                     cancel_hotbackup.sql
rem 
rem     Copyright (C) Oriole Software, 1998
rem 
rem     Downloaded from http://www.oriolecorp.com
rem 
rem     This script for Oracle database administration is free software; you
rem     can redistribute it and/or modify it under the terms of the GNU General
rem     Public License as published by the Free Software Foundation; either
rem     version 2 of the License, or any later version.
rem 
rem     This script is distributed in the hope that it will be useful,
rem     but WITHOUT ANY WARRANTY; without even the implied warranty of
rem     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
rem     GNU General Public License for more details.
rem 
rem     You should have received a copy of the GNU General Public License
rem     along with this program; if not, write to the Free Software
rem     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
rem 
rem =========================================================================
rem
rem   Must be run by a DBA.
rem
rem   IT IS EXTREMELY IMPORTANT TO RUN THIS SCRIPT AS SOON AS POSSIBLE
rem   IN THE EVENT OF FAILURE OF THE hotbackup.sql SCRIPT.
rem
--
--  CANCELLING IN-BACKUP STATE ...
--
set linesize 100
set pause off
set pagesize 0
set echo off
set feedback off
set recsep off
set scan off
spool cancel_hbu.sql
select 'alter tablespace ' || ts.name || ' end backup;'
from sys.ts$ ts
where ts.ts# in (select f.ts#
                 from sys.file$ f,
                      v$backup b
                 where f.file# = b.file#
                   and b.status = 'ACTIVE');
spool off
set echo on
set feedback on
@cancel_hbu
exit

