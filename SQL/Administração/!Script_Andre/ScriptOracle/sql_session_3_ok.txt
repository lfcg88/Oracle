column status format a10
set feedback off
set serveroutput on size 200000

select username, sid, serial#, process, status 
from v$session 
where username is not null and status='ACTIVE' 
/

column username format a20
column sql_text format a55 word_wrapped

begin
    for x in 
    ( select username||'('||sid||','||serial#||') ospid = ' ||  process || ' program = ' || program username, 
	 to_char(LOGON_TIME,' Day HH24:MI') logon_time, 
	 to_char(sysdate,' Day HH24:MI') current_time, 
             sql_address,
             sql_hash_value
        from v$session
       where status = 'ACTIVE'
         and rawtohex(sql_address) <> '00'
         and username is not null ) loop

--
         dbms_output.put_line( '--------------------' );
         dbms_output.put_line( x.username );
         dbms_output.put_line( x.logon_time || ' ' || x.current_time);
--
        for c1 in ( select * from sys.v_$sqltext
              where HASH_VALUE = x.sql_hash_value order by piece) loop
          dbms_output.put_line(chr(9)||c1.sql_text);
        end loop;
    end loop;
end;
/

c
